"use strict";

var $table = $("#table"),
  $remove = $("#remove"),
  selections = [];
function getIdSelections() {
  return $.map($table.bootstrapTable("getSelections"), function (e) {
    return e.id;
  });
}
function responseHandler(e) {
  return $.each(e.rows, function (e, t) {
    t.state = -1 !== $.inArray(t.id, selections);
  }), e;
}
function detailFormatter(e, t) {
  var a = [];
  return $.each(t, function (e, t) {
    a.push("<p><b>" + e + ":</b> " + t + "</p>");
  }), a.join("");
}
function operateFormatter(e, t, a) {
  return ['<a class="like" href="javascript:void(0)" title="Like">', '<i class="bi bi-heart text-success me-2"></i>', "</a>  ", '<a class="remove" href="javascript:void(0)" title="Remove">', '<i class="bi bi-trash text-danger me-2"></i>', "</a>"].join("");
}
function totalTextFormatter(e) {
  return "Total";
}
function totalNameFormatter(e) {
  return e.length;
}
function totalPriceFormatter(e) {
  var t = this.field;
  return "$" + e.map(function (e) {
    return +e[t].substring(1);
  }).reduce(function (e, t) {
    return e + t;
  }, 0);
}
function initTable() {
  $table.bootstrapTable("destroy").bootstrapTable({
    height: 650,
    buttonsClass: "light btn-icon",
    locale: $("#locale").val(),
    columns: [[{
      field: "state",
      checkbox: !0,
      rowspan: 2,
      align: "center",
      valign: "middle"
    }, {
      title: "ID",
      field: "id",
      rowspan: 2,
      align: "center",
      valign: "middle",
      sortable: !0,
      footerFormatter: totalTextFormatter
    }, {
      title: "Details",
      colspan: 3,
      align: "center"
    }], [{
      field: "name",
      title: "Name",
      sortable: !0,
      footerFormatter: totalNameFormatter,
      align: "center"
    }, {
      field: "price",
      title: "Price",
      sortable: !0,
      align: "center",
      footerFormatter: totalPriceFormatter
    }, {
      field: "operate",
      title: "Operate",
      align: "center",
      clickToSelect: !1,
      events: window.operateEvents,
      formatter: operateFormatter
    }]]
  }), $table.on("check.bs.table uncheck.bs.table check-all.bs.table uncheck-all.bs.table", function () {
    $remove.prop("disabled", !$table.bootstrapTable("getSelections").length), selections = getIdSelections();
  }), $table.on("all.bs.table", function (e, t, a) {
    console.log(t, a);
  }), $remove.on("click", function () {
    var e = getIdSelections();
    $table.bootstrapTable("remove", {
      field: "id",
      values: e
    }), $remove.prop("disabled", !0);
  });
}
window.operateEvents = {
  "click .like": function clickLike(e, t, a, o) {
    alert("You click like action, row: " + JSON.stringify(a));
  },
  "click .remove": function clickRemove(e, t, a, o) {
    $table.bootstrapTable("remove", {
      field: "id",
      values: [a.id]
    });
  }
}, $(function () {
  initTable(), $("#locale").on("change", initTable);
});