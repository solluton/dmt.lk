"use strict";

function initKanbanSortable() {
  $('[data-sortable="true"]').sortable({
    connectWith: ".connect-sorting-content",
    items: ".card",
    cursor: "move",
    placeholder: "ui-state-highlight",
    refreshPosition: !0,
    stop: function stop(a, t) {
      t.item.parent().attr("data-item");
    },
    update: function update(a, t) {
      console.log(t), console.log(t.item);
    }
  });
}
function initClearItem() {
  $(".list-clear-all").off("click").on("click", function (a) {
    a.preventDefault(), $(this).parents('[data-action="sorting"]').find(".connect-sorting-content .card").remove();
  });
}
function initAddKanbanItem() {
  $(".addTask").on("click", function (a) {
    a.preventDefault(), a = $(this).parents('[data-action="sorting"]').attr("data-item"), $(".edit-task-title").hide(), $(".add-task-title").show(), $('[data-btn-action="addTask"]').show(), $('[data-btn-action="editTask"]').hide(), kanban_add(a);
  });
}
function kanban_add(e) {
  $('[data-btn-action="addTask"]').off("click").on("click", function (a) {
    a.preventDefault(), $(this).attr("class").split(" ")[1];
    var a = e,
      t = document.getElementById("kanban-title").value,
      i = document.getElementById("kanban-text").value,
      t = '<div class="card card-item ui-sortable-handle" data-draggable="true"><div class="card-header px-3 py-2 d-flex align-items-center gap-4"><h5 class="fs-14 fw-medium card-title" data-item-title="' + t + '">' + t + '</h5><div class="dropdown ms-auto"><a href="javascript:void(0);" data-bs-toggle="dropdown"><i class="fi fi-br-menu-dots fs-12"></i></a><div class="dropdown-menu dropdown-menu-end dropdown-sm"><div data-edash-trigger="edash-aside-right-open"><a class="dropdown-item kanban-item-edit" href="javascript:void(0);"><i class="fi fi-rr-pen-nib fs-12"></i><span class="ms-2">Edit</span></a></div><a class="dropdown-item kanban-item-delete" href="javascript:void(0);"><i class="fi fi-rr-delete fs-12"></i><span class="ms-2">Delete</span></a></div></div></div><div class="card-body p-3"><p class="fs-12 fw-light text-muted mb-0" data-item-text="' + i + '">' + i + '</p><div class="my-3"><span class="badge bg-success-subtle text-success">Admin</span><span class="badge bg-danger-subtle text-danger">Dashboard</span></div><div class="d-flex align-items-center"><div class="avatar-group avatar-group-sm"><div class="avatar avatar-sm"><img src="./../assets/images/avatar/1.png" class="img-fluid rounded-circle" alt="User Avatar"></div><div class="avatar avatar-sm"><img src="./../assets/images/avatar/2.png" class="img-fluid rounded-circle" alt="User Avatar"></div><div class="avatar avatar-sm"><img src="./../assets/images/avatar/3.png" class="img-fluid rounded-circle" alt="User Avatar"></div></div><div class="hstack gap-3 ms-auto"><a href="javascript:void(0);" class="hstack gap-1"><i class="fi fi-rr-comment-alt-dots fs-12"></i><span class="fs-12">8</span></a><a href="javascript:void(0);" class="hstack gap-1"><i class="fi fi-rr-paperclip-vertical fs-12"></i><span class="fs-12">4</span></a></div></div></div></div>';
    $("[data-item='" + a + "'] .connect-sorting-content").append(t), initKanbanEdit(), initKanbanDelete();
  });
}
function initEditItem() {
  $(".list-edit").off("click").on("click", function (a) {
    a.preventDefault();
    var i = $(this),
      a = ($(".add-list").hide(), $(".edit-list").show(), $(".add-list-title").hide(), $(".edit-list-title").show(), i.parents('[data-action="sorting"]').find(".item-head").attr("data-item-title"));
    $("#item-name").val(a), $(".edit-list").off("click").on("click", function (a) {
      $(this);
      var t = document.getElementById("item-name").value;
      i.parents('[data-action="sorting"]').find(".item-head").html(t), i.parents('[data-action="sorting"]').find(".item-head").attr("data-item-title", t);
      $("#addBoardModal").modal("hide"), $("#item-name").val("");
    }), $("#addBoardModal").modal("show"), $("#addBoardModal").on("hidden.bs.modal", function (a) {
      $("#item-name").val("");
    });
  });
}
function initDeleteItem() {
  $(".list-delete").off("click").on("click", function (a) {
    a.preventDefault(), $(this).parents("[data-action]").remove();
  });
}
function initKanbanDelete() {
  $(".card-item .kanban-item-delete").off("click").on("click", function (a) {
    var t;
    a.preventDefault(), t = $(this).parents(".card-item"), $("#deleteConformation").modal("show"), $('[data-remove="task"]').on("click", function (a) {
      a.preventDefault(), t.remove(), $("#deleteConformation").modal("hide");
    });
  });
}
function initKanbanEdit() {
  $(".card-item .kanban-item-edit").off("click").on("click", function (a) {
    a.preventDefault();
    var e = $(this),
      a = ($(".add-task-title").hide(), $(".edit-task-title").show(), $('[data-btn-action="addTask"]').hide(), $('[data-btn-action="editTask"]').show(), e.parents(".card-item").find("h5").attr("data-item-title")),
      a = ($(".task-text-progress #kanban-title").val(a), e.parents(".card-item").find('p:not(".progress-count")').attr("data-item-text"));
    $(".task-text-progress #kanban-text").val(a);
    $('[data-btn-action="editTask"]').off("click").on("click", function (a) {
      var t = document.getElementById("kanban-title").value,
        i = document.getElementById("kanban-text").value;
      e.parents(".card-item").find("h5").attr("data-item-title", t), e.parents(".card-item").find("h5").html(t), e.parents(".card-item").find('p:not(".progress-count")').attr("data-tasktext", i), e.parents(".card-item").find('p:not(".progress-count")').html(i);
    });
  });
}
$("#addKanbanBoard").off("click").on("click", function (a) {
  a.preventDefault(), $(".add-list").show(), $(".edit-list").hide(), $(".edit-list-title").hide(), $(".add-list-title").show(), $("#addBoardModal").modal("show");
}), $(".add-list").off("click").on("click", function (a) {
  var t = document.getElementById("item-name").value,
    i = t.toLowerCase().split(" ").join("_"),
    i = '<div class="connect-sorting-content d-flex flex-column gap-3 ui-sortable" data-sortable="true"><div data-item="item-' + i + '" class="task-list-container wd-300 flex-shrink-0" data-action="sorting"><div class="connect-sorting connect-sorting-' + i + '"><div class="d-flex align-items-center mb-4"><h6 class="item-head fs-16 fw-bold mb-0" data-item-title="' + t + '">' + t + '</h6><div class="dropdown ms-auto"><a href="javascript:void(0);" data-bs-toggle="dropdown" aria-expanded="false"><i class="fi fi-br-menu-dots-vertical fs-12"></i></a><div class="dropdown-menu dropdown-menu-end dropdown-sm"><a class="dropdown-item list-edit" href="javascript:void(0);"><i class="fi fi-rr-pen-nib fs-12"></i><span class="ms-2">Edit</span></a><a class="dropdown-item list-delete" href="javascript:void(0);"><i class="fi fi-rr-delete fs-12"></i><span class="ms-2">Delete</span></a><a class="dropdown-item list-clear-all" href="javascript:void(0);"><i class="fi fi-rr-trash fs-12"></i><span class="ms-2">Clear Alls</span></a></div></div></div><div class="connect-sorting-content d-flex flex-column gap-3" data-sortable="true">NaN<div class="d-grid mt-3"><a class="addTask btn btn-md btn-soft-primary w-100" data-edash-trigger="edash-aside-right-open">Add Tasks</a></div></div></div></div>';
  $(".task-list-section").append(i), $("#addBoardModal").modal("hide"), $("#item-name").val(""), initKanbanSortable(), initEditItem(), initDeleteItem(), initClearItem(), initAddKanbanItem(), initKanbanEdit(), initKanbanDelete();
}), $(function () {
  initEditItem(), initDeleteItem(), initClearItem(), initAddKanbanItem(), initKanbanEdit(), initKanbanDelete(), initKanbanSortable();
});